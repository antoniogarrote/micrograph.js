<!doctype html>

<!--[if lt IE 7 ]>
    <html class="no-js ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]>
    <html class="no-js ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]>
    <html class="no-js ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->
<html class="no-js" lang="en"> <!--<![endif]-->

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Example 1</title>
    <meta name="author" content="Antonio Garrote">

    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript" src="./js/ko.js"></script>
    <script type="text/javascript" src="./js/micrograph.js"></script>

    <script type="text/javascript">
       mg.create(function(g) {
           g.from("https://www.googleapis.com/freebase/v1/search?query=ipad&callback=matches")
            .load(function() {
        
        	 g.where({name: {$like: "^iPad( [23])?$"}})
                 .map(function(match) {
                     return match.mid;
                 })
                 .each_cc(function(mid, k) {
                     g.from("https://www.googleapis.com/freebase/v1/mqlread?query={\"mid\":\""+mid+"\",\"type\":\"/base/gadgets/gadget\",\"*\":null}&callback=laodgadget").load(k);
        	  })
        	  .all(function() {
        	      g.where({type:"/base/gadgets/gadget",
                              name: g._("name"),
        		       weight: g._("weight")})
        	       .tuples(function(result) {
        		   ko.applyBindings({ipads: result});
        	       })
        	  })
        
            });
       });
    </script>
  </head>

  <body>
    <table data-bind="foreach: ipads">
     <tr><td data-bind="text:name"></td><td data-bind="text:weight"></td></tr>
   </table>
  </body>

</html>
